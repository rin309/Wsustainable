# Wsustainable
`現在プレビュー版として公開しているため、全機能は実装されていません。また、仕様を大きく変更する可能性があるため、本番環境に組み込まないでください。`
このツールは、選択したサーバー上に既に構成されている WSUS (Windows Server Update Services サービス) における更新プログラムの拒否を自動化するためのツールです。

# 事前に必要な作業
事前に WSUS をインストール、構成してください。(https://jpmem.github.io/blog/wsus/2023-02-16_01/)

- 製品: クライアントで使用している製品のみ選択する (https://qiita.com/rin309/items/7872d2772f02c4eb33a6)
- 分類: ドライバー、ドライバーセット以外の使用する項目を選択する (https://jpmem.github.io/blog/wsus/2018-06-19_01/)
- 言語: 日本語、英語
- 同期スケジュール: 自動
- 自動承認: 必要に応じて構成してください (自動承認を有効にすると、スクリプト動作までの間にタイムラグが発生します)

# インストールと使い方
- https://github.com/rin309/Wsustainable/wiki/Install
- https://github.com/rin309/Wsustainable/wiki/HowToUse

# ログの確認
下記フォルダーに保存されます。
既定で10回分の動作ログが保存されます。
C:\ProgramData\Wsustainable\0.1\Logs\

# 実行アカウント
ログインしていない状態でも実行させるために SYSTEM ユーザーを指定していますが、下記の理由で変更されたい場合もあると思われます。
  
- 動作しないため、エラー画面を表示させたい
- プロキシなどのネットワーク環境要因によって、ユーザーを指定したい
- 動作する権限を最小限にするため、ユーザーを指定したい
  
このスクリプトでは、実行権限・フォルダーやネットワークへのアクセス権限に問題が無ければ実行できると考えております。  
必要に応じて、ユーザーの変更はタスクスケジューラーから行ってください。  
![Optimize-WsusContents のプロパティ (ローカル コンピューター)](https://user-images.githubusercontent.com/760251/230722128-428d6ed1-ae26-48ee-8892-dc52784ae8ee.png)
